"use strict";const e=require("../../common/vendor.js"),a=require("../../utils/dateFormat.js");if(!Array){(e.resolveComponent("u-icon")+e.resolveComponent("u-radio")+e.resolveComponent("u-radio-group")+e.resolveComponent("l-calendar"))()}Math||((()=>"../../node-modules/uview-plus/components/u-icon/u-icon.js")+(()=>"../../node-modules/uview-plus/components/u-radio/u-radio.js")+(()=>"../../node-modules/uview-plus/components/u-radio-group/u-radio-group.js")+i+(()=>"../../uni_modules/l-calendar/components/l-calendar/l-calendar.js"))();const i=()=>"../option-bt.js",t=e.defineComponent({__name:"otherinfo",props:{showFlag:{type:Boolean}},emits:["next"],setup(i,{emit:t}){const o=t,r=i,{appContext:_}=e.getCurrentInstance(),n=_.config.globalProperties,s=e.reactive({tips_popup:!1,tips_timer:null,tipsText:"资料未填写完成",id_card_array:[{front:"",back:""}],calenderShow:!1,timeKey:""});e.index.getStorageSync("setInfoFormData")&&(s.id_card_array=[{front:e.index.getStorageSync("setInfoFormData").card_image_front,back:e.index.getStorageSync("setInfoFormData").card_image_back}]);const d=e.reactive({materials:{id_card_image:[],hukou_image:[],marry_image:[],house_image:[],house_power_image:[]},has_weituo:"Y",has_shengming:"N",shengming_extend:{marry_status:""},has_xieyi:"N",xieyi_extend:{xieyi_type:"a",house_where:"",marry_time:"",marry_end_time:"",who_has_house:"",who_has:"",share_plan:"",marry_again_time:"",who_has_income:""}});e.onMounted((()=>{n.$request("/loan/Order/getOrderDetail",{order_id:e.index.getStorageSync("order_id"),page_number:9}).then((e=>{if(0!==e.data.order_material.length&&(Object.assign(d,e.data.order_material),!r.showFlag&&0!==d.materials.id_card_image.length)){s.id_card_array=[];let e=d.materials.id_card_image.length/2;for(let a=0;a<e;a++)s.id_card_array.push({front:d.materials.id_card_image[2*a],back:d.materials.id_card_image[2*a+1]})}}))}));const l=a=>{e.index.previewImage({current:a,urls:[a]})},m=(e,a)=>{d.materials[e].splice(a,1)},x=e=>{r.showFlag||(s.timeKey=e,s.calenderShow=!0)},h=()=>{if(r.showFlag)return;d.materials.id_card_image=[];let e=!0;s.id_card_array.map((a=>{""!==a.front&&""!==a.back||(e=!1)})),e?s.id_card_array.push({front:"",back:""}):g("请先上传完整身份证件")},y=a=>{e.index.chooseImage({count:1,success:i=>{e.index.showLoading({title:"上传中，请稍后……"});const t=i.tempFilePaths[0].split("/"),o=t[t.length-1];n.$request("",{file:i.tempFiles[0].path,fileType:"file",params:{fileSize:parseFloat((i.tempFiles[0].size/1024).toFixed(2)),fileName:o}}).then((i=>{s.id_card_array[s.id_card_array.length-1][a]=i.data.url,e.index.hideLoading()}))}})},p=e=>{d.xieyi_extend[s.timeKey]=a.dateFormat(e.result,"yyyy年MM月dd日")},g=e=>{s.tipsText=e,s.tips_popup=!0,null!==s.tips_timer&&clearTimeout(s.tips_timer),s.tips_timer=setTimeout((()=>{s.tips_popup=!1}),2e3)},c=a=>{e.index.chooseImage({count:9,success:i=>{e.index.showLoading({title:"上传中，请稍后……"}),i.tempFiles.map((i=>{const t=i.path.split("/"),o=t[t.length-1];n.$request("",{file:i.path,fileType:"file",params:{fileSize:parseFloat((i.size/1024).toFixed(2)),fileName:o}}).then((i=>{d.materials[a].push(i.data.url),e.index.hideLoading()}))}))}})};return(a,i)=>e.e({a:!r.showFlag},(r.showFlag,{}),{b:!r.showFlag},r.showFlag?{d:e.f(d.materials.id_card_image,((a,i,t)=>({a:a,b:e.o((e=>l(a)),i),c:i})))}:{c:e.f(s.id_card_array,((a,i,t)=>e.e({a:a.front},a.front?{b:a.front}:{},{c:e.o((e=>y("front")),i),d:a.back},a.back?{e:a.back}:{},{f:e.o((e=>y("back")),i),g:i})))},{e:!r.showFlag},r.showFlag?{}:{f:e.o(h)},{g:e.f(d.materials.hukou_image,((a,i,t)=>e.e({a:a,b:e.o((e=>l(a)),i)},r.showFlag?{}:{c:"0adabe04-0-"+t,d:e.p({name:"close-circle",size:"20px",color:"#000000"}),e:e.o((e=>m("hukou_image",i)),i)},{f:i}))),h:!r.showFlag,i:!r.showFlag},r.showFlag?{}:{j:e.o((e=>c("hukou_image")))},{k:e.f(d.materials.marry_image,((a,i,t)=>e.e({a:a,b:e.o((e=>l(a)),i)},r.showFlag?{}:{c:"0adabe04-1-"+t,d:e.p({name:"close-circle",size:"20px",color:"#000000"}),e:e.o((e=>m("marry_image",i)),i)},{f:i}))),l:!r.showFlag,m:!r.showFlag},r.showFlag?{}:{n:e.o((e=>c("marry_image")))},{o:e.f(d.materials.house_image,((a,i,t)=>e.e({a:a,b:e.o((e=>l(a)),i)},r.showFlag?{}:{c:"0adabe04-2-"+t,d:e.p({name:"close-circle",size:"20px",color:"#000000"}),e:e.o((e=>m("house_image",i)),i)},{f:i}))),p:!r.showFlag,q:!r.showFlag},r.showFlag?{}:{r:e.o((e=>c("house_image")))},{s:e.f(d.materials.house_power_image,((a,i,t)=>e.e({a:a,b:e.o((e=>l(a)),i)},r.showFlag?{}:{c:"0adabe04-3-"+t,d:e.p({name:"close-circle",size:"20px",color:"#000000"}),e:e.o((e=>m("house_power_image",i)),i)},{f:i}))),t:!r.showFlag,v:!r.showFlag},r.showFlag?{}:{w:e.o((e=>c("house_power_image")))},{x:e.p({name:"Y",label:"是"}),y:e.p({name:"N",label:"否"}),z:e.o((e=>d.has_weituo=e)),A:e.p({placement:"row","active-color":"#F97E39",disabled:r.showFlag,modelValue:d.has_weituo}),B:e.p({name:"Y",label:"是"}),C:e.p({name:"N",label:"否"}),D:e.o((e=>d.has_shengming=e)),E:e.p({placement:"row","active-color":"#F97E39",disabled:r.showFlag,modelValue:d.has_shengming}),F:"Y"===d.has_shengming},"Y"===d.has_shengming?{G:r.showFlag,H:d.shengming_extend.marry_status,I:e.o((e=>d.shengming_extend.marry_status=e.detail.value))}:{},{J:e.p({name:"Y",label:"是"}),K:e.p({name:"N",label:"否"}),L:e.o((e=>d.has_xieyi=e)),M:e.p({placement:"row","active-color":"#F97E39",disabled:r.showFlag,modelValue:d.has_xieyi}),N:"Y"===d.has_xieyi},"Y"===d.has_xieyi?e.e({O:e.p({name:"a",label:"协议书"}),P:e.p({name:"b",label:"离婚补充协议书"}),Q:e.p({name:"c",label:"婚前确认协议书"}),R:e.p({name:"d",label:"复婚协议书"}),S:e.o((e=>d.xieyi_extend.xieyi_type=e)),T:e.p({placement:"row","active-color":"#F97E39",disabled:r.showFlag,modelValue:d.xieyi_extend.xieyi_type}),U:r.showFlag,V:d.xieyi_extend.house_where,W:e.o((e=>d.xieyi_extend.house_where=e.detail.value)),X:e.t(d.xieyi_extend.marry_time||"请选择结婚时间"),Y:e.s(d.xieyi_extend.marry_time?"":"color:#777777"),Z:e.o((e=>x("marry_time"))),aa:"a"===d.xieyi_extend.xieyi_type||"b"===d.xieyi_extend.xieyi_type},"a"===d.xieyi_extend.xieyi_type||"b"===d.xieyi_extend.xieyi_type?{ab:r.showFlag,ac:d.xieyi_extend.who_has_house,ad:e.o((e=>d.xieyi_extend.who_has_house=e.detail.value))}:{},{ae:"a"===d.xieyi_extend.xieyi_type},"a"===d.xieyi_extend.xieyi_type?{af:r.showFlag,ag:d.xieyi_extend.who_has_income,ah:e.o((e=>d.xieyi_extend.who_has_income=e.detail.value))}:{},{ai:"b"===d.xieyi_extend.xieyi_type||"c"===d.xieyi_extend.xieyi_type||"d"===d.xieyi_extend.xieyi_type},"b"===d.xieyi_extend.xieyi_type||"c"===d.xieyi_extend.xieyi_type||"d"===d.xieyi_extend.xieyi_type?{aj:e.t(d.xieyi_extend.marry_end_time||"请选择离婚时间"),ak:e.s(d.xieyi_extend.marry_end_time?"":"color:#777777"),al:e.o((e=>x("marry_end_time")))}:{},{am:"b"===d.xieyi_extend.xieyi_type},"b"===d.xieyi_extend.xieyi_type?{an:r.showFlag,ao:d.xieyi_extend.who_has,ap:e.o((e=>d.xieyi_extend.who_has=e.detail.value)),aq:r.showFlag,ar:d.xieyi_extend.share_plan,as:e.o((e=>d.xieyi_extend.share_plan=e.detail.value))}:{},{at:"d"===d.xieyi_extend.xieyi_type},"d"===d.xieyi_extend.xieyi_type?{av:e.t(d.xieyi_extend.marry_again_time||"请选择复婚时间"),aw:e.s(d.xieyi_extend.marry_again_time?"":"color:#777777"),ax:e.o((e=>x("marry_again_time")))}:{}):{},{ay:!r.showFlag},(r.showFlag,{}),{az:!r.showFlag},r.showFlag?{}:{aA:e.o((a=>(()=>{if(d.materials.id_card_image=[],s.id_card_array.map((e=>{""!==e.front&&d.materials.id_card_image.push(e.front),""!==e.back&&d.materials.id_card_image.push(e.back)})),d.materials.id_card_image.length%2!=1)if("Y"!==d.has_shengming||""!==d.shengming_extend.marry_status){if("Y"===d.has_xieyi){if(""===d.xieyi_extend.house_where||""===d.xieyi_extend.marry_time)return void g("资料未填写完成");if("a"===d.xieyi_extend.xieyi_type&&(""===d.xieyi_extend.who_has_income||""===d.xieyi_extend.who_has_house))return void g("资料未填写完成");if("b"===d.xieyi_extend.xieyi_type&&(""===d.xieyi_extend.who_has_house||""===d.xieyi_extend.marry_end_time||""===d.xieyi_extend.who_has||""===d.xieyi_extend.share_plan))return void g("资料未填写完成");if("c"===d.xieyi_extend.xieyi_type&&""===d.xieyi_extend.marry_end_time)return void g("资料未填写完成");if("d"===d.xieyi_extend.xieyi_type&&""===d.xieyi_extend.marry_again_time)return void g("资料未填写完成")}n.$request("/loan/Order/makeOrder",{id:e.index.getStorageSync("order_id"),page_number:9,...d}).then((()=>{o("next")}))}else g("资料未填写完成");else g("资料未填写完成")})()))},{aB:s.tips_popup},s.tips_popup?{aC:e.t(s.tipsText)}:{},{aD:e.o(p),aE:e.o((e=>s.calenderShow=!1)),aF:e.p({visible:s.calenderShow,isRange:!1})})}});wx.createComponent(t);
