"use strict";const e=require("../../common/vendor.js"),a=require("../../utils/jump.js");Math||(i+t)();const i=()=>"../../components/navbar.js",t=()=>"../../components/option-bt.js",o=e.defineComponent({__name:"index",setup(i){const{appContext:t}=e.getCurrentInstance(),o=t.config.globalProperties;e.index.showShareMenu({withShareTicket:!0,menus:["shareAppMessage","shareTimeline"]});const r=e.reactive({timeNum:59,codeTimer:null,codeText:"发送验证码",tips_popup:!1,tips_timer:null,tipsText:"资料未填写完成",verifyFlag:!0}),c=e.reactive({verify_code:"",auth_mobile:"",name:"",id_card:"",id_card_image_front:"",id_card_image_back:""}),n=e=>{r.tipsText=e,r.tips_popup=!0,null!==r.tips_timer&&clearTimeout(r.tips_timer),r.tips_timer=setTimeout((()=>{r.tips_popup=!1}),2e3)},d=a=>{e.index.chooseImage({count:1,success:i=>{e.index.showLoading({title:"上传中，请稍后……"});const t=i.tempFilePaths[0].split("/"),r=t[t.length-1];o.$request("",{file:i.tempFiles[0].path,fileType:"file",params:{fileSize:parseFloat((i.tempFiles[0].size/1024).toFixed(2)),fileName:r}}).then((i=>{"front"===a?(c.id_card_image_front=i.data.url,e.index.request({url:"https://cardnumber.market.alicloudapi.com/rest/160601/ocr/ocr_idcard.json",header:{Authorization:"APPCODE 5076c8ae1e57459986eb77b688d5d91d"},method:"POST",data:{image:i.data.url,configure:{side:"face"}},success:e=>{let a=e.data;c.name=a.name,c.id_card=a.num},fail:()=>{n("请按要求上传身份证人像面（正面）")}})):c.id_card_image_back=i.data.url,e.index.hideLoading()}))}})};return(i,t)=>e.e({a:e.p({title:"数据服务授权"}),b:c.id_card_image_front},c.id_card_image_front?{c:c.id_card_image_front}:{},{d:e.o((e=>d("front"))),e:c.id_card_image_back},c.id_card_image_back?{f:c.id_card_image_back}:{},{g:e.o((e=>d("back"))),h:c.name,i:e.o((e=>c.name=e.detail.value)),j:c.id_card,k:e.o((e=>c.id_card=e.detail.value)),l:c.auth_mobile,m:e.o((e=>c.auth_mobile=e.detail.value)),n:e.o((e=>{""!==c.auth_mobile&&""!==c.id_card&&""!==c.name?a.navigateTo("/home_packages/service_sign/index",c):n("资料未填写完成")})),o:e.o((e=>i.$back())),p:e.p({showCancel:!0,cancelText:"返回",cancelColor:"#999999",cancelBgColor:"#F6F7FB"}),q:r.tips_popup},r.tips_popup?{r:e.t(r.tipsText)}:{})}});wx.createPage(o);
