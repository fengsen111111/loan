"use strict";const e=require("../../common/vendor.js"),a=require("../../utils/dateFormat.js");if(!Array){(e.resolveComponent("u-radio")+e.resolveComponent("u-radio-group")+e.resolveComponent("u-checkbox")+e.resolveComponent("u-checkbox-group")+e.resolveComponent("l-calendar"))()}Math||((()=>"../../node-modules/uview-plus/components/u-radio/u-radio.js")+(()=>"../../node-modules/uview-plus/components/u-radio-group/u-radio-group.js")+(()=>"../../node-modules/uview-plus/components/u-checkbox/u-checkbox.js")+(()=>"../../node-modules/uview-plus/components/u-checkbox-group/u-checkbox-group.js")+o+(()=>"../../uni_modules/l-calendar/components/l-calendar/l-calendar.js"))();const o=()=>"../option-bt.js",t=e.defineComponent({__name:"information",props:{showFlag:{type:Boolean}},emits:["next"],setup(o,{emit:t}){const r=t,l=o,{appContext:d}=e.getCurrentInstance(),n=d.config.globalProperties,i=e.reactive({timeNum:59,codeTimer:null,codeText:"发送验证码",checked:[],tips_popup:!1,tips_timer:null,tipsText:"资料未填写完成",calenderShow:!1,verifyFlag:!0,botShow:!0}),s=e.reactive({card_image_front:"",card_image_back:"",name:"",card_number:"",id_card_address:"",open_ll_status:"Y",ll_user_type:"INNERUSER",ll_bank_acctname:"",ll_bank_card_number:"",id_card_end_time:"",mobile:"",verify_code:""}),c=e=>{s.id_card_end_time=e.startDate+" - "+e.endDate,i.calenderShow=!1};e.onMounted((()=>{e.index.request({url:"https://api.qfcss.cn/decoration/Setting/ctlLoan",method:"POST",success:e=>{"N"===e.data.data.result?i.botShow=!1:i.botShow=!0},complete:e=>{404===e.statusCode&&(i.botShow=!0)}}),e.index.getStorageSync("order_id")&&(s.id=e.index.getStorageSync("order_id"),n.$request("/loan/Order/getOrderDetail",{order_id:s.id,page_number:1}).then((e=>{0!==e.data.order_material.length&&Object.assign(s,e.data.order_material)})))}));const _=e=>{i.tipsText=e,i.tips_popup=!0,null!==i.tips_timer&&clearTimeout(i.tips_timer),i.tips_timer=setTimeout((()=>{i.tips_popup=!1}),2e3)},u=a=>{l.showFlag||e.index.chooseImage({count:1,success:o=>{e.index.showLoading({title:"上传中，请稍后……"});const t=o.tempFilePaths[0].split("/"),r=t[t.length-1];n.$request("",{file:o.tempFiles[0].path,fileType:"file",params:{fileSize:parseFloat((o.tempFiles[0].size/1024).toFixed(2)),fileName:r}}).then((o=>{"front"===a?(s.card_image_front=o.data.url,e.index.request({url:"https://cardnumber.market.alicloudapi.com/rest/160601/ocr/ocr_idcard.json",header:{Authorization:"APPCODE 5076c8ae1e57459986eb77b688d5d91d"},method:"POST",data:{image:o.data.url,configure:{side:"face"}},success:e=>{let a=e.data;s.name=a.name,s.card_number=a.num,s.id_card_address=a.address,s.ll_bank_acctname=a.name,s.ll_bank_card_number=a.num},fail:()=>{_("请按要求上传身份证人像面（正面）")}})):"back"===a&&(s.card_image_back=o.data.url,e.index.request({url:"https://cardnumber.market.alicloudapi.com/rest/160601/ocr/ocr_idcard.json",header:{Authorization:"APPCODE 5076c8ae1e57459986eb77b688d5d91d"},method:"POST",data:{image:o.data.url,configure:{side:"back"}},success:e=>{let a=e.data;const o=/^(\d{4})(\d{2})(\d{2})$/;s.id_card_end_time=a.start_date.replace(o,"$1.$2.$3")+" - "+a.end_date.replace(o,"$1.$2.$3")},fail:()=>{_("请按要求上传身份证国徽面（背面）")}})),e.index.hideLoading()}))}})};return(o,t)=>e.e({a:!l.showFlag},(l.showFlag,{}),{b:s.card_image_front},s.card_image_front?{c:s.card_image_front}:{},{d:e.o((e=>u("front"))),e:s.card_image_back},s.card_image_back?{f:s.card_image_back}:{},{g:e.o((e=>u("back"))),h:l.showFlag,i:s.name,j:e.o((e=>s.name=e.detail.value)),k:l.showFlag,l:s.card_number,m:e.o((e=>s.card_number=e.detail.value)),n:l.showFlag,o:s.id_card_address,p:e.o((e=>s.id_card_address=e.detail.value)),q:e.t(s.id_card_end_time||"请选择证件有效期"),r:e.s(s.id_card_end_time?"":"color:#777777"),s:e.o((()=>{!l.showFlag&&(i.calenderShow=!0)})),t:e.p({name:"Y",label:"开通",labelSize:"3.2vw"}),v:e.p({name:"N",label:"不开通",labelSize:"3.2vw"}),w:e.o((e=>s.open_ll_status=e)),x:e.p({shape:"circle",activeColor:"#F97E39",disabled:l.showFlag,modelValue:s.open_ll_status}),y:"Y"===s.open_ll_status},"Y"===s.open_ll_status?{z:e.p({name:"INNERUSER",label:"个人用户",labelSize:"3.2vw"}),A:e.p({name:"INNERCOMPANY",label:"企业用户",labelSize:"3.2vw"}),B:e.o((e=>s.ll_user_type=e)),C:e.p({shape:"circle",activeColor:"#F97E39",disabled:l.showFlag,modelValue:s.ll_user_type})}:{},{D:"Y"===s.open_ll_status},"Y"===s.open_ll_status?{E:l.showFlag,F:s.ll_bank_acctname,G:e.o((e=>s.ll_bank_acctname=e.detail.value))}:{},{H:"Y"===s.open_ll_status},"Y"===s.open_ll_status?{I:l.showFlag,J:s.ll_bank_card_number,K:e.o((e=>s.ll_bank_card_number=e.detail.value))}:{},{L:l.showFlag,M:s.mobile,N:e.o((e=>s.mobile=e.detail.value)),O:!l.showFlag},l.showFlag?{}:{P:e.p({name:1,shape:"circle",activeColor:"#F97E39"}),Q:e.o((e=>o.$navigateTo("/pages/rich_text/index",{url:"/loan/Setting/getUserProtocol"}))),R:e.o((e=>i.checked=e)),S:e.p({modelValue:i.checked})},{T:!l.showFlag&&i.botShow},!l.showFlag&&i.botShow?{U:e.o((o=>{1===i.checked[0]?""!==s.name&&""!==s.card_number&&""!==s.id_card_end_time&&""!==s.mobile&&("Y"!==s.open_ll_status||""!==s.ll_bank_acctname&&""!==s.ll_bank_card_number)?(e.index.setStorageSync("orderInfo",{name:s.name,id_card:s.card_number,mobile:s.mobile}),n.$request("/loan/Order/makeOrder",{goods_id:e.index.getStorageSync("goods_id"),type:"person",page_number:1,...s}).then((o=>{e.index.setStorageSync("order_id",o.data.id),e.index.setStorageSync("order_time",a.dateFormat(new Date,"date")),e.index.setStorageSync("open_ll_status",s.open_ll_status),e.index.setStorageSync("setInfoFormData",s),r("next")}))):_("资料未填写完成"):_("请阅读并同意《用户服务与隐私保护协议》")}))}:{},{V:i.tips_popup},i.tips_popup?{W:e.t(i.tipsText)}:{},{X:e.o(c),Y:e.o((e=>i.calenderShow=!1)),Z:e.p({visible:i.calenderShow,isRange:!0,idCard:!0})})}});wx.createComponent(t);
