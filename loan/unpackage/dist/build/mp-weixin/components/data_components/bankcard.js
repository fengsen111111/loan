"use strict";const e=require("../../common/vendor.js"),a=require("../../common/assets.js");if(!Array){e.resolveComponent("u-icon")()}Math||((()=>"../../node-modules/uview-plus/components/u-icon/u-icon.js")+t)();const t=()=>"../option-bt.js",o=e.defineComponent({__name:"bankcard",props:{showFlag:{type:Boolean}},emits:["next"],setup(t,{emit:o}){const r=o,n=t,{appContext:i}=e.getCurrentInstance(),d=i.config.globalProperties,s=e.reactive({front:"",behind:"",timeNum:59,codeTimer:null,codeText:"发送验证码",checked:[1],tips_popup:!1,tips_timer:null,tipsText:"资料未填写完成",orderInfo:e.index.getStorageSync("orderInfo"),column:[],pub_picker:!1,select_value:0,verifyFlag:!0}),l=e.reactive({bank_name:"",bank_number:"",bank_mobile:""});e.onMounted((()=>{d.$request("/loan/Bank/getBankList").then((e=>{s.column=e.data.list})),d.$request("/loan/Order/getOrderDetail",{order_id:e.index.getStorageSync("order_id"),page_number:3}).then((e=>{0!==e.data.order_material.length&&Object.assign(l,e.data.order_material)})),d.$request("/loan/Order/getOrderDetail",{order_id:e.index.getStorageSync("order_id"),page_number:1}).then((e=>{s.orderInfo={name:e.data.order_material.name,id_card:e.data.order_material.card_number}}))}));const c=e=>{s.select_value=e.detail.value[0]};return(t,o)=>e.e({a:!n.showFlag},(n.showFlag,{}),{b:e.t(s.orderInfo.name),c:e.t(s.orderInfo.id_card),d:n.showFlag,e:l.bank_number,f:e.o((e=>l.bank_number=e.detail.value)),g:a._imports_0$9,h:e.o((a=>{n.showFlag||e.index.chooseImage({count:1,success:a=>{e.index.showLoading({title:"上传中，请稍后……"});const t=a.tempFilePaths[0].split("/"),o=t[t.length-1];d.$request("",{file:a.tempFiles[0].path,fileType:"file",params:{fileSize:parseFloat((a.tempFiles[0].size/1024).toFixed(2)),fileName:o}}).then((a=>{e.index.request({url:"https://yhk.market.alicloudapi.com/rest/160601/ocr/ocr_bank_card.json",header:{Authorization:"APPCODE 5076c8ae1e57459986eb77b688d5d91d"},method:"POST",data:{image:a.data.url},success:e=>{let a=e.data;l.bank_number=a.card_num}}),e.index.hideLoading()}))}})})),i:e.t(l.bank_name),j:e.p({name:"arrow-down",size:"5vw",color:"#666666"}),k:e.o((e=>{n.showFlag||(s.pub_picker=!0)})),l:n.showFlag,m:l.bank_mobile,n:e.o((e=>l.bank_mobile=e.detail.value)),o:!n.showFlag},n.showFlag?{}:{p:e.o((a=>{d.$request("/loan/Order/makeOrder",{id:e.index.getStorageSync("order_id"),page_number:3,...l}).then((()=>{r("next")}))}))},{q:s.tips_popup},s.tips_popup?{r:e.t(s.tipsText)}:{},{s:s.pub_picker},s.pub_picker?{t:e.o((e=>s.pub_picker=!1)),v:e.o((e=>(l.bank_name=s.column[s.select_value].name,s.select_value=0,void(s.pub_picker=!1)))),w:e.f(s.column,((a,t,o)=>({a:e.t(a.name),b:t}))),x:e.o(c)}:{},{y:s.pub_picker},s.pub_picker?{z:e.o((e=>s.pub_picker=!1))}:{})}});wx.createComponent(o);
