"use strict";const e=require("../../common/vendor.js"),o=require("../../common/assets.js");if(!Array){e.resolveComponent("u-icon")()}Math||((()=>"../../node-modules/uview-plus/components/u-icon/u-icon.js")+t)();const t=()=>"../option-bt.js",a=e.defineComponent({__name:"bankcard",props:{showFlag:{type:Boolean}},emits:["next"],setup(t,{emit:a}){const n=a,r=t,{appContext:i}=e.getCurrentInstance(),s=i.config.globalProperties,l=e.reactive({front:"",behind:"",timeNum:59,codeTimer:null,codeText:"发送验证码",checked:[1],tips_popup:!1,tips_timer:null,tipsText:"资料未填写完成",orderInfo:e.index.getStorageSync("orderInfo"),column:[],pub_picker:!1,select_value:0,verifyFlag:!0}),p=e.reactive({bank_name:"",bank_number:"",bank_mobile:""});e.onMounted((()=>{s.$request("/loan/Bank/getBankList").then((e=>{l.column=e.data.list})),s.$request("/loan/Order/getOrderDetail",{order_id:e.index.getStorageSync("order_id"),page_number:3}).then((e=>{0!==e.data.order_material.length&&Object.assign(p,e.data.order_material)}))}));const d=e=>{l.select_value=e.detail.value[0]};return(t,a)=>e.e({a:!r.showFlag},(r.showFlag,{}),{b:e.t(l.orderInfo.name),c:e.t(l.orderInfo.id_card),d:r.showFlag,e:p.bank_number,f:e.o((e=>p.bank_number=e.detail.value)),g:o._imports_0$9,h:e.o((o=>{r.showFlag||e.index.chooseImage({count:1,success:o=>{e.index.showLoading({title:"上传中，请稍后……"});const t=o.tempFilePaths[0].split("/"),a=t[t.length-1];s.$request("",{file:o.tempFiles[0].path,fileType:"file",params:{fileSize:parseFloat((o.tempFiles[0].size/1024).toFixed(2)),fileName:a}}).then((o=>{e.index.request({url:"https://yhk.market.alicloudapi.com/rest/160601/ocr/ocr_bank_card.json",header:{Authorization:"APPCODE 5076c8ae1e57459986eb77b688d5d91d"},method:"POST",data:{image:o.data.url},success:e=>{let o=e.data;p.bank_number=o.card_num}}),e.index.hideLoading()}))}})})),i:e.t(p.bank_name),j:e.p({name:"arrow-down",size:"5vw",color:"#666666"}),k:e.o((e=>{r.showFlag||(l.pub_picker=!0)})),l:r.showFlag,m:p.bank_mobile,n:e.o((e=>p.bank_mobile=e.detail.value)),o:!r.showFlag},r.showFlag?{}:{p:e.o((o=>{s.$request("/loan/Order/makeOrder",{id:e.index.getStorageSync("order_id"),page_number:3,...p}).then((()=>{n("next")}))}))},{q:l.tips_popup},l.tips_popup?{r:e.t(l.tipsText)}:{},{s:l.pub_picker},l.pub_picker?{t:e.o((e=>l.pub_picker=!1)),v:e.o((e=>(p.bank_name=l.column[l.select_value].name,l.select_value=0,void(l.pub_picker=!1)))),w:e.f(l.column,((o,t,a)=>({a:e.t(o.name),b:t}))),x:e.o(d)}:{},{y:l.pub_picker},l.pub_picker?{z:e.o((e=>l.pub_picker=!1))}:{})}});wx.createComponent(a);
