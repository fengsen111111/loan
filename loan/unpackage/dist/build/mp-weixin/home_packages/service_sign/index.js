"use strict";const e=require("../../common/vendor.js");if(!Array){(e.resolveComponent("u-checkbox")+e.resolveComponent("u-checkbox-group")+e.resolveComponent("u-icon"))()}Math||(t+(()=>"../../node-modules/uview-plus/components/u-checkbox/u-checkbox.js")+(()=>"../../node-modules/uview-plus/components/u-checkbox-group/u-checkbox-group.js")+o+(()=>"../../node-modules/uview-plus/components/u-icon/u-icon.js"))();const t=()=>"../../components/navbar.js",o=()=>"../../components/option-bt.js",i=e.defineComponent({__name:"index",props:{verify_code:{type:String},auth_mobile:{type:String},name:{type:String},id_card:{type:String},id_card_image_front:{type:String},id_card_image_back:{type:String},auth_sign_image:{type:String}},setup(t){const{appContext:o}=e.getCurrentInstance(),i=o.config.globalProperties;e.index.showShareMenu({withShareTicket:!0,menus:["shareAppMessage","shareTimeline"]});const a=t,n=e.reactive({timeNum:59,codeTimer:null,codeText:"发送验证码",tips_popup:!1,tips_timer:null,tipsText:"资料未填写完成",autograph:"",checked:[],popup_tips:!1,flag:!0}),p=e.reactive({...a,auth_sign_image:""});e.onShow((()=>{if("empty"===e.index.getStorageSync("autograph"))return n.autograph="",void e.index.removeStorageSync("autograph");if(e.index.getStorageSync("autograph")){n.autograph=e.index.getStorageSync("autograph");const t=n.autograph.split("/"),o=t[t.length-1];e.index.getFileSystemManager().getFileInfo({filePath:n.autograph,success:e=>{i.$request("",{file:n.autograph,fileType:"file",params:{fileSize:parseFloat((e.size/1024).toFixed(2)),fileName:o}}).then((e=>{p.auth_sign_image=e.data.url}))}}),e.index.removeStorageSync("autograph")}}));const r=e=>{n.tipsText=e,n.tips_popup=!0,null!==n.tips_timer&&clearTimeout(n.tips_timer),n.tips_timer=setTimeout((()=>{n.tips_popup=!1}),2e3)};return(t,o)=>e.e({a:e.p({title:"数据服务授权"}),b:p.id_card_image_front},p.id_card_image_front?{c:p.id_card_image_front}:{},{d:p.id_card_image_back},p.id_card_image_back?{e:p.id_card_image_back}:{},{f:e.t(p.name),g:e.t(p.id_card),h:e.t(p.auth_mobile),i:e.p({name:1,shape:"circle"}),j:e.o((e=>t.$navigateTo("/pages/rich_text/index",{url:"/loan/Setting/getDigitalAgreeContent",title:"电子签意授权书"}))),k:e.o((e=>t.$navigateTo("/pages/rich_text/index",{url:"/loan/Setting/getUserMessageAuthContent",title:"征信授权书"}))),l:e.o((e=>n.checked=e)),m:e.p({modelValue:n.checked}),n:""!==p.auth_sign_image},""!==p.auth_sign_image?{o:p.auth_sign_image}:{},{p:e.o((e=>t.$navigateTo("/home_packages/autograph/index",{name:p.name}))),q:e.o((e=>{1===n.checked[0]?""!==p.auth_sign_image?n.popup_tips=!0:r("资料未填写完成"):r("请阅读并同意相关授权书")})),r:e.o((e=>t.$back())),s:e.p({confirmText:"提交",confirmBgColor:"#1592E6",showCancel:!0,cancelText:"返回",cancelColor:"#999999",cancelBgColor:"#F6F7FB"}),t:n.popup_tips},n.popup_tips?{v:e.o((e=>n.popup_tips=!1)),w:e.p({name:"close",size:"5vw",color:"#666666"}),x:e.o((e=>n.popup_tips=!1)),y:e.o((t=>{n.flag&&(n.popup_tips=!1,n.flag=!1,e.index.showLoading({title:"请稍后"}),i.$request("/loan/User/authorization",p).then((()=>{e.index.hideLoading(),e.index.showToast({title:"数据服务授权成功",icon:"none",duration:2e3}),setTimeout((()=>{n.flag=!0,e.index.switchTab({url:"/pages/user_home/index"})}),2e3)})))}))}:{},{z:n.popup_tips},n.popup_tips?{A:e.o((e=>n.popup_tips=!1))}:{},{B:n.tips_popup},n.tips_popup?{C:e.t(n.tipsText)}:{})}});wx.createPage(i);
